# Базовые слова в DevOps в 2020 году

Кратко описание: в рамках данной лекции будут даны базовые термины и понятия, которые необходимо освоить перед изучением более глубоких процессов разработки.

Ключевые слова:

- Code flow;
- Репозиторий;
- Контейнеризация и виртуализация;
- Configuration management;
- Observability;
- Everything as Code;
- IaaS\PaaS\SaaS\FaaS;
- CI\CD\CD.

## Базовые термины, понятия и инструменты

### Code flow

Code flow — это описание процесса ведения кодовой базы приложения. На текущий момент разделяют 4 типа.

1. One flow:
Процесс, при котором у вас есть только главная ветвь, в которой хранится кодовая база. Отсутствует ветка разработки, а все новые ветви создаются напрямую от мастера и коммитятся также напрямую в мастер. Разработка по данному типу упрощает сам процесс разработки, но имеет повышенный риск поломать приложение. Присутствует жесткая типизация возможных веток и их назначение;
2. Git Flow:
Процесс, при котором у вас есть главная и ветвь разработки. Разработческая ветвь является пре-продуктовой версией. Все новые ветви исходят от разработческой ветви и впоследствии сливаются с ней. В момент, когда готов новый релиз, разработческая ветвь сливается с главной, которая впоследствии компилируется в готовое приложение. Присутствует жесткая типизация возможных веток и их назначение;
3. GitHub Flow:
Упрощённая версия Git Flow. У вас есть главная ветвь, от нее исходя ветви с названием предполагаемого функционала. После всех проверок ветвь с новым функционалом сливается с главной ветвью. Отсутствует жесткая типизация возможных веток и их назначение;
4. GitLab Flow:
Процесс разработки, который совмещает в себе GitLab Flow и GitHub Flow. Так, у вас нет разработческой ветви, а есть только ветви нового функционала. Релизы строятся на базе тегов мастера, теги создает пользователь, а тестируются все коммиты, а не только те, которые являются релизными. Прямой коммит в мастер запрещен при любых обстоятельствах. Отсутствует жесткая типизация возможных веток и их назначение.

### Репозиторий

Репозиторий — это место, где хранятся какие-либо данные.
Любая программа в своем изначальном виде представляет из себя строки кода, которые необходимо где-то хранить. Если вы работаете над проектом один, делать это можно на личном компьютере, однако возникает вопрос с сохранностью данных на случай аппаратного-программного сбоя и возникает проблема передачи данного кода другим разработчикам в случае расширения команды разработчиков до N+1.
Для решения данной проблемы используется программа под названием git, которая отвечает за распределенное версионирование программного кода. Для более простой дистрибьюции используют сторонние продукты, построенные поверх git`a. На текущий момент лидерами рынка среди репозиториев для исходного кода можно назвать следующее программное обеспечение:

- GitHub Enterprise;
- GitLab;
- Atlassian Bitbucket.

После того, как Вы собрали Ваше приложение, собранные артефакты необходимо где-то хранить для дальнейшей дистрибьюции. На текущий момент лидерами рынка среди репозиториев для артефактов являются:

- Jfrog Artifactory;
- Sonatype Nexus;
- GitHub Packages (стадия открытого бета-тестирования);
- GitLab Package Registry (набирает популярность).

### Контейнеризация и виртуализация виртуальных машин

#### Виртуальные машины

Виртуальные машины — это тип виртуализации, направленный на создание виртуальной машины на базе физического машины. Так имея одну мощную физическую машину, можно создать несколько виртуальных с более низкими показателями по потребляемым ресурсам. Так же это удобно для горизонтального и вертикального масштабирования, т.к. физическое место в машинном зале дата-центра может закончится и понадобится арендовать место где-то еще или на складе не будет находится необходимых конфигураций. Данные проблемы снимает виртуализация, когда вы создаете виртуальный аналог вашего сервера в рамках пользовательского интерфейса.
На текущий момент лидерами в виртуализации машин являются:

- VMware ESXi;
- Openstack;
- Proxmox.

#### Контейнеризация

Наравне с виртуальными машинами существует еще один вид виртуализации — это контейнеризация. В отличие от виртуализации целых машин, контейнеризация — это виртуализация на уровне ядра системы. Так, ядро поддерживает не одно пространство пользователя, а несколько, в рамках которых работают контейнера с собственным набором программного обеспечения.
На текущий момент лидерами контейнеризации являются:

- Docker;
- Cri-o;
- Containerd.

Однако, сами по себе контейнеры являются локальным программным обеспечением и для работы в состоянии кластера им необходимо множество дополнительных программных средств. Их общность называется “оркестратор”.
На текущий момент лидерами среди оркестраторов являются:

- Kubernetes;
- Rancher;
- OCP или OKD.

Для большей наглядности архитектурных различий между контейнерами и виртуальными машинами см. Скрин на слайде.

### Configuration management

С увеличением количества рабочих машин под управлением администраторов появилась необходимость в унификации их конфигурации, настройки и централизации всех изменений. Программные компоненты, отвечающие за централизованную конфигурацию, появились еще в 90е года XX века. На текущий момент лидерами рынка являются следующие компоненты:

- Ansible;
- Chef;
- SaltStack;
- Puppet.

Отличает их язык программирования, на котором они написаны, необходимость наличия агента на клиенте и наличия централизованного сервера, необходимость наличия сохраняемого состояния.

### Observability

Observability, или наблюдаемость системы, является совокупностью двух составляющих:

- Мониторинг;
- Логирование.

Благодаря их совокупности мы можем строить предсказания касательно утилизации ресурсов, а также будущего поведения системы. Анализировать ошибки, частоту их появления в зависимости от разных показателей и многое другое для достижения большей стабильности, предсказуемости и управляемости инфраструктуры.

#### Мониторинг

Мониторинг — это процесс наблюдения за показателями работы системы. Например, утилизация ЦПУ, объем занятой и свободной оперативной памяти, скорость чтения/записи файловой подсистемы или отдельных жестких дисков. Сюда же относятся цифирные метрики, например, относящиеся к запросам на веб-сервер или скорость выполнения SQL запросов в рамках базы данных.
На текущий момент можно выделить следующих лидеров рынка:

- Prometheus;
- Zabbix;
- Datadog;
- Sysdig.
  
#### Логирование

Логирование - это процесс, направленный на сбор, хранение, обработку и анализ поступающих логов из используемых программных компонентов для поиска ошибок или отклонений.

Лидерами рынка на текущий момент являются:

- EL(F)K (E - ElasticSearch, L - logstah, F - Fluentd|Fluentbit, K - Kibana);
- Splunk;
- Grafana Loki (набирает популярность).

### Everything as Code

Данная практика утверждает, что все можно описать как код: само приложение, его настройки или инфраструктуру на всех ее уровнях.
Лидерами рынка являются:

- Terraform;
- Pulumi.

### As a Service

As a Service является подходом, когда инфраструктуру (IaaS), платформу исполнения (PaaS), приложение (SaaS) или функцию (FaaS) можно получить как сервис по запросу. Разница данных *aaS заключается лишь в инфраструктурном уровне, который оставляется на обеспечение у провайдера услуги.
Для примера можно привести следующие варианты на базе облачного решения от компании Google:

- Google Cloud Platform — это инфраструктура As a Service, где вы можете создать собственную инфраструктуру из различных компонентов;
- Google Kubernetes Engine - уже готовая платформа исполнения, куда Вам необходимо лишь загрузить собственные контейнеры и все будет работать;
- G-Suite - приложение As a Service, где Вы можете зарегистрировать свою компанию, завести сотрудников в аналоге AD от Microsoft, создать корпоративную почту и многое другое;
- Cloud Functions  - функция As a Service, когда Вы только загружаете свой код, а всю работу по его запуску, поддержке, масштабированию и прочие инфраструктурные задачи берет на себя провайдер.

Полный спектр *aaS решений на текущий момент предоставляют только крупные игроки вроде AWS\Google\Azure. Однако и более мелкие игроки, например DO, стараются реализовать у себя схожий функционал. Также стоит отметить, что китайские облачные решения тоже набирают популярность. Например, Alibaba Cloud доступен как для юридических, так и для физических лиц, а Huawei Cloud - только для корпоративных клиентов.

### CI/CD/CD

При разработке программного обеспечения используются разные типы команд. Это может быть как одна большая команда, так и несколько небольших. Пока идет раздельный процесс разработки все хорошо, ни у кого нет никаких проблем, каждая команда устраняет баги в своем коде самостоятельно. Однако, стоит им начать процесс слияния собственного кода для последующей компиляции, это превращается в общую головную боль, т.к. возникают разнообразные ошибки. Для решения данной проблемы была введена процедура непрекращающейся интеграции, или continuous integration (CI). Это процесс, при котором разработчик делает коммит собственного кода в общий репозиторий каждый раз, как хочет проверить, что его код работает и совместим с кодом своих коллег. На данном этапе происходит самые базовые функции, а именно: сборка приложения и синтетические тесты.

После сборки приложения его необходимо доставить в репозиторий артефактов на другие этапы проверок, которые, как итог, будут гарантировать, что в любой момент времени любая прошедшая полный цикл CI\CD версия приложения готова к публикации на продуктовой платформе. Этот процесс называется continuous delivery (CD).

Однако, каждый раз публиковать приложении в ручном режиме не всегда удобно, а также увеличивает время выхода приложения на рынок. Для устранения этой проблемы было предложено логичное продолжение данного процесса в виде непрекращающейся публикации, или continuous deployment (CD). В рамках данного процесса любая готовая и проверенная версия приложения будет опубликована на продуктовой платформе.

## Список литературы

- [Git SCM](https://git-scm.com/book/ru/v2)
- [YouTube: Introduction to Virtualization and VMware Hypervisor Architecture](https://www.youtube.com/watch?v=EvXn2QiL3gs&ab_channel=VMware)
- [Containerization](https://www.ibm.com/cloud/learn/containerization)
- [Medium: The beginning of ‘Everything as Code’](https://medium.com/swlh/the-beginning-of-everything-as-code-a25c4e9a75e9)
- [Medium: What is Everything-as-Code?](https://hackernoon.com/everything-as-code-explained-0ibg32a3)
- [XaaS explained: an as-a-service overview](https://www.parkersoftware.com/blog/xaas-explained-an-as-a-service-overview/)
- [Serverless Functions, Made Simple](https://www.openfaas.com/)
- [CI\CD\CD](https://www.atlassian.com/continuous-delivery/principles/continuous-integration-vs-delivery-vs-deployment)
- [Monitoring and Observability — What’s the Difference and Why Does It Matter?](https://thenewstack.io/monitoring-and-observability-whats-the-difference-and-why-does-it-matter/)
